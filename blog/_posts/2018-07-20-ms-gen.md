---
layout: post
title: The shocking truth about Maelstrom
date: 2018-07-21 09:00:00
author: slanderman
---

*This mini-blog is the first of a series I have planned that answers a single 'theorycrafting' question in each instalment, a different topic in each instalment. If reception of this style post is good, I'll be writing more in the future.*

---


## Background information

This week's 8.0 'pre-patch' launch brought some Maelstrom generation changes for Elemental Shaman. The single target changes are as follows:

- {{site.data.spell.lb}} Maelstrom generation increased from 6 to 8.
- {{site.data.spell.lvb}} Maelstrom generation increased from 8 to 10.

As an aside, note that {{site.data.spell.mastery}} procs generate Maelstrom at a 50% reduced rate. This means {{site.data.spell.lb}} procs now generate 4, {{site.data.spell.lvb}} procs now generate 5, and {{site.data.spell.cl}} procs generate 2 (unchanged from before due to rounding).

## Defining the question

For this first blog, we'll just stick to {{site.data.spell.es}} and the single target implications of this change. So you may wonder:

> "What are the implications of this Maelstrom generation increase on Earth Shock, and how are various Maelstrom-generation related talents affected by these changes?"

Let's take things slowly. First we'll need to know what talents will be impacted by these generation changes:

- {{site.data.talent.ee}} - more Maelstrom means more casts of {{site.data.spell.es}}, which means more debuffs for higher {{site.data.spell.lb}} damage.
- {{site.data.talent.afs}} - more Maelstrom again means more frequent casts of {{site.data.spell.es}}, though {{site.data.talent.afs}} acts more directly with Maelstrom. This increase in {{site.data.spell.es}} cast frequency will have a synergistic effect with {{site.data.talent.afs}}, sometimes called a "positive feedback loop" in that the more times {{site.data.talent.afs}} procs, the more chances it has to proc again.
- {{site.data.talent.hv}} - an increase in Maelstrom from each {{site.data.spell.mastery}} has a pretty clear effect on this talent. 

With these three talents in mind, we have to consider what measures we can observe to compare the effect of the Maelstrom generation changes. SimulationCraft provides us with a lot heap of data, but for our query here we're only interested in Maelstrom generation and Earth Shock casts. So we have our question defined in some more specific terms:

> "How do the Maelstrom generation changes affect spell-wise Maelstrom generation and Earth Shock cast frequency?"


## Observing the baseline

To answer this, we can look to the "Resources: Maelstrom Gains" section, and the "Abilities: Earth Shock" section of SimulationCraft. For a breakdown of what spells generate how much Maelstrom over the course of a fight, this pie chart is a nice summary:

![Baseline Maelstrom generation by spell, before pre-patch buff](/assets/img/blog/maelstrom-gen-baseline.png){:class="img-responsive"}

*If you're confused as to why the numbers here have fractions of Maelstrom points, remember that SimulationCraft runs hundreds or thousands of iterations and returns a mean (average) result. These numbers are simply the average amount of Maelstrom generated by each spell across 10,000 simulations.*

The Earth Shock frequency is summarised in a table format:

&nbsp; | Interval (s) | Execution (count)
--- | --- | ---
No talents | 14.45 | 20.5 
High Voltage | 13.84 | 21.3
Aftershock | 10.88 | 26.6
Aftershock + High Voltage | 10.57 | 27.6

What this table reveals to us is the effects of different talent combinations on the interval (also known as *frequency*, or time between casts) and execution (the number of casts). So we have our baseline numbers; now we have to apply the Maelstrom generation changes to SimulationCraft and test again.


## Conducting the experiment

Since we're using a version of SimulationCraft that does not have the changes included, we'll have to manually override some spell data:


```
override.spell_data=effect.284316.base_value=10
override.spell_data=effect.279203.base_value=8
override.spell_data=effect.723962.base_value=4
override.spell_data=effect.723963.base_value=5
```

In order, these overrides set the Maelstrom generation values of the following spells: {{site.data.spell.lvb}}, {{site.data.spell.lb}}, {{site.data.spell.lb}} Overload, {{site.data.spell.lvb}} Overload. I won't go into how these effect IDs are found in this blog, but perhaps spell data and overrides will be covered in a later post.

Running our simulation again gives us some quite different results for {{site.data.spell.es}} frequency:

&nbsp; | Interval (s) | Execution (count)
--- | --- | ---
No talents | 11.56 | 25.6
High Voltage | 11.11 | 26.7
Aftershock | 8.96 | 32.9
Aftershock + High Voltage | 8.57 | 34.2

We'll convert this to a table of differences to make the comparison a bit easier:

&nbsp; | Interval difference (s) | Execution difference (count)
--- | --- | ---
No talents | -2.89 | 5.1
High Voltage | -2.73 | 5.4
Aftershock | -1.92 | 6.3
Aftershock + High Voltage | -2.0 | 6.6
Mean | -2.39 | 6.08

A negative interval difference can be better thought of reducing the time between {{site.data.spell.es}} casts. The `-2.73` second interval for High Voltage means that on average, the Maelstrom generation changes cause you to cast each {{site.data.spell.es}} 2.73 seconds faster.

This is also reflected in the increased execution count -- the number of {{site.data.spell.es}} casts -- meaning we're casting more {{site.data.spell.es}} over the course of the fight (this is implied in the interval difference, but as a more easily understood concept). The few data points we can derive from these results are:

1. {{site.data.talent.afs}} - the {{site.data.spell.es}} interval is impacted less by these Maelstrom generation changes than the base spec (-1.92 sec vs -2.89 sec), but the total number of casts is increased more than the base spec (+5.1 casts vs. +6.3 casts).
1. {{site.data.talent.hv}} - the Maelstrom generation changes impact this the most in terms of time to cast {{site.data.spell.es}} (interval).
1. The synergy between {{site.data.talent.afs}} and {{site.data.talent.hv}} leads to a minor increase in {{site.data.spell.es}} cast count, and the interval is at its lowest with these two talents, but the interval is not as impacted (comparing before and after changes) when {{site.data.talent.afs}} is active. This is in part due to the randomness of {{site.data.talent.afs}}, and any positive-feedback effects arising from a higher level of Maelstrom generation and {{site.data.talent.afs}} togther are small at best.
1. Looking at mean values, we can conclude that across a variety of talent states (no talents vs. single talents vs. talent combinations), the Maelstrom changes lead to a 2.4 second *decrease* in the time between {{site.data.spell.es}} casts, which in turn leads to an average of ~6 additional {{site.data.spell.es}} casts in a 300 second fight.

## Summary

This was a short look at the effects of Maelstrom generation on the frequency of Earth Shock casts. It's a simple question, but the methods to find the answer are sometimes not obvious to the inexperienced. I hope this is a digestible first look at the process and way of thinking typical of "theorycrafting". 